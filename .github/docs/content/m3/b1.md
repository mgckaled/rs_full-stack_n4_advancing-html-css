# CSS Functions - Guia de Referência

> [Voltar](../../../../m3/README.md) a página anterior

## Índice

- [CSS Functions - Guia de Referência](#css-functions---guia-de-referência)
  - [Índice](#índice)
  - [Introdução](#introdução)
  - [Funções de Transformação](#funções-de-transformação)
    - [Transform Functions](#transform-functions)
      - [Transformações 2D](#transformações-2d)
      - [Transformações 3D](#transformações-3d)
      - [Considerações sobre Performance](#considerações-sobre-performance)
  - [Funções Matemáticas](#funções-matemáticas)
    - [`calc()`](#calc)
      - [Precedência e Limitações](#precedência-e-limitações)
    - [`min()`, `max()`, `clamp()`](#min-max-clamp)
    - [`round()`, `mod()`, `rem()`](#round-mod-rem)
    - [`sin()`, `cos()`, `tan()`, `asin()`, `acos()`, `atan()`, `atan2()`](#sin-cos-tan-asin-acos-atan-atan2)
    - [`abs()`, `sign()`, `exp()`, `log()`, `sqrt()`, `pow()`, `hypot()`](#abs-sign-exp-log-sqrt-pow-hypot)
  - [Funções de Filtro](#funções-de-filtro)
    - [filter](#filter)
    - [backdrop-filter](#backdrop-filter)
  - [Funções de Cores](#funções-de-cores)
    - [Cores RGB e RGBA](#cores-rgb-e-rgba)
    - [Cores HSL e HSLA](#cores-hsl-e-hsla)
    - [Cores HWB](#cores-hwb)
    - [Cores Lab e LCH](#cores-lab-e-lch)
    - [`oklab()` e `oklch()`](#oklab-e-oklch)
    - [`color()`](#color)
    - [`color-mix()`](#color-mix)
    - [`color-contrast()`](#color-contrast)
    - [Funções Relativas de Cor](#funções-relativas-de-cor)
  - [Funções de Degradê](#funções-de-degradê)
    - [`linear-gradient()`](#linear-gradient)
    - [`radial-gradient()`](#radial-gradient)
    - [`conic-gradient()`](#conic-gradient)
    - [`repeating-linear-gradient()`, `repeating-radial-gradient()`, `repeating-conic-gradient()`](#repeating-linear-gradient-repeating-radial-gradient-repeating-conic-gradient)
  - [Funções de Formas](#funções-de-formas)
    - [`clip-path` com Funções de Forma](#clip-path-com-funções-de-forma)
      - [`circle()`](#circle)
      - [`ellipse()`](#ellipse)
      - [`inset()`](#inset)
      - [`polygon()`](#polygon)
      - [`path()`](#path)
    - [`shape-outside:`](#shape-outside)
    - [`offset-path`](#offset-path)
  - [Funções que Referenciam Outros Valores](#funções-que-referenciam-outros-valores)
    - [`var()`](#var)
    - [`attr()`](#attr)
    - [`env()`](#env)
    - [Custom Properties com Tipagem](#custom-properties-com-tipagem)
  - [Funções de Grid e Layout](#funções-de-grid-e-layout)
    - [`repeat()`](#repeat)
    - [`minmax()`](#minmax)
    - [`fit-content()`](#fit-content)
  - [Funções de Imagem](#funções-de-imagem)
    - [`image()`](#image)
    - [`image-set()`](#image-set)
    - [`cross-fade()`](#cross-fade)
    - [`element()`](#element)
  - [Funções de Contadores](#funções-de-contadores)
    - [`counter()` e `counters()`](#counter-e-counters)
    - [`symbols()`](#symbols)
  - [Funções de Conteúdo Gerado](#funções-de-conteúdo-gerado)
    - [`content()` e Suas Variações](#content-e-suas-variações)
  - [Funções de Animação e Timing](#funções-de-animação-e-timing)
    - [`Cubic-bezier()`](#cubic-bezier)
    - [`steps()`](#steps)
    - [`linear()`](#linear)
  - [Funções de Medidas e Viewports](#funções-de-medidas-e-viewports)
    - [Unidades de Viewport](#unidades-de-viewport)
  - [Funções Matemáticas Especiais](#funções-matemáticas-especiais)
    - [Operadores e Comparações](#operadores-e-comparações)
  - [Funções de Seleção e Posição](#funções-de-seleção-e-posição)
    - [`:is()`, `:where()`, `:has()`](#is-where-has)
  - [Funções Avançadas e Experimentais](#funções-avançadas-e-experimentais)
    - [`anchor()`](#anchor)
    - [`scroll()`](#scroll)
    - [`view()`](#view)
  - [Performance e Otimização](#performance-e-otimização)
    - [Funções que Ativam GPU](#funções-que-ativam-gpu)
    - [Contain e Content-visibility](#contain-e-content-visibility)
  - [Práticas Avançadas e Patterns](#práticas-avançadas-e-patterns)
    - [Design Tokens com Funções](#design-tokens-com-funções)
    - [Temas Dinâmicos](#temas-dinâmicos)
    - [Aspect Ratio Responsivo](#aspect-ratio-responsivo)
    - [Logical Properties](#logical-properties)
  - [Considerações de Compatibilidade](#considerações-de-compatibilidade)
    - [Feature Queries](#feature-queries)
    - [Fallbacks Estratégicos](#fallbacks-estratégicos)
  - [Conclusão](#conclusão)

---

## Introdução

CSS Functions são expressões que retornam valores computados dinamicamente durante o processo de renderização. Diferentemente de valores estáticos, funções permitem cálculos, referências contextuais e transformações complexas, tornando o CSS mais dinâmico e adaptável.

## Funções de Transformação

### Transform Functions

As funções de transformação manipulam o sistema de coordenadas do elemento, aplicando operações geométricas sem afetar o layout circundante.

#### Transformações 2D

```css
.elemento {
  /* Translação */
  transform: translate(50px, 100px);
  transform: translateX(50px);
  transform: translateY(100px);
  
  /* Escala */
  transform: scale(1.5, 2);
  transform: scaleX(1.5);
  transform: scaleY(2);
  
  /* Rotação */
  transform: rotate(45deg);
  
  /* Inclinação */
  transform: skew(10deg, 20deg);
  transform: skewX(10deg);
  transform: skewY(20deg);
  
  /* Matriz de transformação */
  transform: matrix(1, 0.5, -0.5, 1, 0, 0);
}
```

#### Transformações 3D

```css
.elemento-3d {
  /* Translação 3D */
  transform: translate3d(50px, 100px, 75px);
  transform: translateZ(75px);
  
  /* Escala 3D */
  transform: scale3d(1.5, 2, 0.8);
  transform: scaleZ(0.8);
  
  /* Rotação 3D */
  transform: rotate3d(1, 1, 0, 45deg);
  transform: rotateX(45deg);
  transform: rotateY(45deg);
  transform: rotateZ(45deg);
  
  /* Perspectiva */
  transform: perspective(500px) rotateY(45deg);
  
  /* Matriz 3D */
  transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);
}
```

#### Considerações sobre Performance

Transformações que utilizam `translate3d()` ou `translateZ()` podem ativar aceleração de hardware, melhorando significativamente a performance de animações. A função `will-change` pode ser combinada para otimização adicional.

## Funções Matemáticas

### `calc()`

Permite operações aritméticas com diferentes unidades, resolvendo cálculos em tempo de renderização.

```css
.container {
  width: calc(100% - 80px);
  height: calc(100vh - 120px);
  padding: calc(1rem + 5px);
  
  /* Cálculos aninhados */
  margin: calc(calc(100% / 3) - 20px);
  
  /* Operações complexas */
  font-size: calc(1rem + (2vw - 1rem) * ((100vw - 320px) / (1920 - 320)));
}
```

#### Precedência e Limitações

Operadores devem ser separados por espaços. Divisão e multiplicação têm precedência sobre adição e subtração. Divisão por zero resulta em valor inválido.

### `min()`, `max()`, `clamp()`

Funções comparativas para valores responsivos e adaptativos.

```css
.responsivo {
  /* Escolhe o menor valor */
  width: min(100%, 800px, 90vw);
  
  /* Escolhe o maior valor */
  font-size: max(1rem, 2vw, 12px);
  
  /* Limita entre min e max: clamp(min, preferido, max) */
  font-size: clamp(1rem, 2.5vw, 2rem);
  padding: clamp(1rem, 5%, 3rem);
  
  /* Cálculos combinados */
  width: clamp(300px, calc(50% - 2rem), 800px);
}
```

### `round()`, `mod()`, `rem()`

Funções matemáticas avançadas introduzidas para arredondamento e operações modulares.

```css
.arredondamento {
  /* Arredonda para o múltiplo mais próximo */
  width: round(up, 101px, 10px); /* 110px */
  width: round(down, 106px, 10px); /* 100px */
  width: round(nearest, 106px, 10px); /* 110px */
  width: round(to-zero, -105px, 10px); /* -100px */
  
  /* Resto da divisão (mod sempre positivo) */
  rotate: mod(750deg, 360deg); /* 30deg */
  
  /* Resto com sinal do dividendo */
  rotate: rem(750deg, 360deg); /* 30deg */
  rotate: rem(-750deg, 360deg); /* -30deg */
}
```

### `sin()`, `cos()`, `tan()`, `asin()`, `acos()`, `atan()`, `atan2()`

Funções trigonométricas para animações e layouts complexos.

```css
.trigonometria {
  /* Valores em radianos ou graus */
  rotate: calc(45deg * sin(30deg));
  
  /* Cálculos de posicionamento circular */
  --angle: 45deg;
  left: calc(50% + 100px * cos(var(--angle)));
  top: calc(50% + 100px * sin(var(--angle)));
  
  /* Funções inversas */
  rotate: asin(0.5); /* 30deg */
  rotate: atan2(1, 1); /* 45deg */
}
```

### `abs()`, `sign()`, `exp()`, `log()`, `sqrt()`, `pow()`, `hypot()`

Funções matemáticas adicionais para cálculos avançados.

```css
.matematica-avancada {
  /* Valor absoluto */
  margin-left: abs(-20px); /* 20px */
  
  /* Sinal (-1, 0, ou 1) */
  --direction: sign(calc(var(--end) - var(--start)));
  
  /* Exponencial e logaritmo */
  opacity: exp(-2); /* e^-2 */
  scale: log(8, 2); /* 3 (log base 2 de 8) */
  
  /* Raiz quadrada e potência */
  width: sqrt(144px); /* 12px */
  width: pow(2, 3); /* 8 */
  
  /* Hipotenusa (teorema de Pitágoras) */
  width: hypot(3px, 4px); /* 5px */
}
```

## Funções de Filtro

### filter

Aplica efeitos gráficos aos elementos, processados pela GPU.

```css
.filtros {
  /* Desfoque */
  filter: blur(5px);
  
  /* Brilho */
  filter: brightness(1.5);
  
  /* Contraste */
  filter: contrast(200%);
  
  /* Escala de cinza */
  filter: grayscale(100%);
  
  /* Inversão */
  filter: invert(100%);
  
  /* Opacidade */
  filter: opacity(50%);
  
  /* Saturação */
  filter: saturate(2);
  
  /* Sépia */
  filter: sepia(80%);
  
  /* Rotação de matiz */
  filter: hue-rotate(90deg);
  
  /* Sombra */
  filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));
  
  /* Múltiplos filtros */
  filter: blur(3px) brightness(1.2) contrast(1.5);
}
```

### backdrop-filter

Aplica filtros ao conteúdo atrás do elemento, criando efeitos de vidro fosco.

```css
.glassmorphism {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.2);
}
```

## Funções de Cores

### Cores RGB e RGBA

```css
.rgb-colors {
  /* RGB tradicional */
  color: rgb(255, 0, 0);
  
  /* RGBA com opacidade */
  background: rgba(0, 128, 255, 0.5);
  
  /* Sintaxe moderna com espaço e barra */
  color: rgb(255 0 0);
  color: rgb(255 0 0 / 0.5);
  
  /* Valores percentuais */
  color: rgb(100% 0% 50%);
}
```

### Cores HSL e HSLA

```css
.hsl-colors {
  /* HSL: Matiz, Saturação, Luminosidade */
  color: hsl(120, 100%, 50%); /* Verde puro */
  
  /* Com alfa */
  background: hsla(240, 50%, 50%, 0.7);
  
  /* Sintaxe moderna */
  color: hsl(120deg 100% 50%);
  color: hsl(120 100% 50% / 0.5);
  
  /* Unidades de ângulo */
  color: hsl(0.33turn 100% 50%); /* 120deg */
  color: hsl(2.09rad 100% 50%); /* ~120deg */
}
```

### Cores HWB

HWB (Hue, Whiteness, Blackness) é uma alternativa mais intuitiva ao HSL.

```css
.hwb-colors {
  /* Matiz, brancura, escuridão */
  color: hwb(120 0% 0%); /* Verde puro */
  color: hwb(120 50% 0%); /* Verde claro */
  color: hwb(120 0% 50%); /* Verde escuro */
  
  /* Com alfa */
  color: hwb(120 20% 20% / 0.8);
}
```

### Cores Lab e LCH

Espaços de cor perceptualmente uniformes, próximos à visão humana.

```css
.lab-lch-colors {
  /* Lab: Luminosidade, componente a, componente b */
  color: lab(50% -40 30);
  color: lab(70% -45 0 / 0.8);
  
  /* LCH: Luminosidade, Croma, Matiz */
  color: lch(50% 50 120);
  color: lch(70% 45 250deg / 0.8);
  
  /* Vantagem: interpolação de cores mais natural */
}
```

### `oklab()` e `oklch()`

Versões melhoradas de Lab e LCH com distribuição de luminosidade mais precisa.

```css
.oklch-colors {
  color: oklch(0.7 0.15 140);
  color: oklch(0.5 0.2 240 / 0.9);
  
  /* Preferível para gradientes e animações */
  background: linear-gradient(
    oklch(0.8 0.15 140),
    oklch(0.4 0.2 240)
  );
}
```

### `color()`

Função genérica para espaços de cor específicos.

```css
.color-function {
  /* Display-P3 (gama mais ampla) */
  color: color(display-p3 1 0.5 0);
  
  /* sRGB */
  color: color(srgb 1 0.5 0 / 0.8);
  
  /* Rec2020 */
  color: color(rec2020 1 0.5 0);
  
  /* Adobe RGB */
  color: color(a98-rgb 1 0.5 0);
}
```

### `color-mix()`

Mistura duas cores em proporções especificadas.

```css
.color-mixing {
  /* Sintaxe: color-mix(in <espaço>, cor1 porcentagem, cor2) */
  background: color-mix(in srgb, red 50%, blue);
  
  /* Espaços de cor diferentes */
  color: color-mix(in oklch, red 70%, blue 30%);
  color: color-mix(in lch, red, blue 40%);
  
  /* Com custom properties */
  --color-primary: blue;
  --color-secondary: yellow;
  background: color-mix(in srgb, var(--color-primary) 60%, var(--color-secondary));
  
  /* Criando variações */
  --base: hsl(200 80% 50%);
  --lighter: color-mix(in hsl, var(--base), white 30%);
  --darker: color-mix(in hsl, var(--base), black 30%);
}
```

### `color-contrast()`

Seleciona a cor com maior contraste de uma lista (ainda em proposta).

```css
.color-contrast {
  /* Seleciona entre as opções a cor com melhor contraste */
  color: color-contrast(var(--background) vs white, black, yellow);
  
  /* Com nível de contraste mínimo */
  color: color-contrast(var(--bg) vs white, black to AA);
}
```

### Funções Relativas de Cor

Modificam cores existentes de forma relativa.

```css
.relative-colors {
  --base: hsl(200 80% 50%);
  
  /* Sintaxe: from <cor> <canal1> <canal2> <canal3> */
  --lighter: hsl(from var(--base) h s calc(l + 10%));
  --more-saturated: hsl(from var(--base) h calc(s + 20%) l);
  --rotated: hsl(from var(--base) calc(h + 180deg) s l);
  
  /* Com RGB */
  --base-rgb: rgb(100 150 200);
  --adjusted: rgb(from var(--base-rgb) calc(r * 1.2) g b);
  
  /* Com LCH */
  --vibrant: lch(from var(--base) calc(l * 1.1) calc(c * 1.5) h);
}
```

## Funções de Degradê

### `linear-gradient()`

Cria gradientes lineares entre cores.

```css
.linear-gradients {
  /* Direção padrão (de cima para baixo) */
  background: linear-gradient(red, blue);
  
  /* Com direção */
  background: linear-gradient(to right, red, blue);
  background: linear-gradient(to bottom right, red, blue);
  background: linear-gradient(45deg, red, blue);
  
  /* Múltiplas cores */
  background: linear-gradient(red, yellow, green, blue);
  
  /* Color stops */
  background: linear-gradient(red 0%, yellow 25%, green 75%, blue 100%);
  
  /* Hard stops para listras */
  background: linear-gradient(90deg, 
    red 0% 33%, 
    yellow 33% 66%, 
    blue 66% 100%
  );
  
  /* Múltiplos gradientes */
  background: 
    linear-gradient(45deg, rgba(255,0,0,0.5), transparent),
    linear-gradient(-45deg, rgba(0,0,255,0.5), transparent);
}
```

### `radial-gradient()`

Gradientes radiais a partir de um ponto central.

```css
.radial-gradients {
  /* Forma e tamanho padrão */
  background: radial-gradient(red, blue);
  
  /* Especificando forma */
  background: radial-gradient(circle, red, blue);
  background: radial-gradient(ellipse, red, blue);
  
  /* Tamanho */
  background: radial-gradient(circle closest-side, red, blue);
  background: radial-gradient(circle closest-corner, red, blue);
  background: radial-gradient(circle farthest-side, red, blue);
  background: radial-gradient(circle farthest-corner, red, blue);
  
  /* Posição */
  background: radial-gradient(circle at top left, red, blue);
  background: radial-gradient(circle at 75% 25%, red, blue);
  
  /* Tamanho explícito */
  background: radial-gradient(circle 100px at center, red, blue);
  background: radial-gradient(ellipse 100px 50px at center, red, blue);
  
  /* Color stops */
  background: radial-gradient(
    circle at center,
    red 0%,
    yellow 30%,
    green 60%,
    blue 100%
  );
}
```

### `conic-gradient()`

Gradientes cônicos que giram em torno de um ponto.

```css
.conic-gradients {
  /* Básico */
  background: conic-gradient(red, yellow, green, blue, red);
  
  /* Com posição */
  background: conic-gradient(at 75% 25%, red, blue);
  
  /* Com ângulo inicial */
  background: conic-gradient(from 45deg, red, blue);
  
  /* Combinado */
  background: conic-gradient(from 90deg at 50% 50%, red, blue);
  
  /* Color stops em graus */
  background: conic-gradient(
    red 0deg,
    yellow 90deg,
    green 180deg,
    blue 270deg,
    red 360deg
  );
  
  /* Gráfico de pizza */
  background: conic-gradient(
    red 0deg 120deg,
    yellow 120deg 240deg,
    blue 240deg 360deg
  );
  
  /* Padrão de raios */
  background: conic-gradient(
    from 0deg,
    black 0deg 10deg,
    white 10deg 20deg,
    black 20deg 30deg,
    white 30deg 40deg
  );
}
```

### `repeating-linear-gradient()`, `repeating-radial-gradient()`, `repeating-conic-gradient()`

Versões repetitivas dos gradientes para padrões.

```css
.repeating-gradients {
  /* Listras diagonais */
  background: repeating-linear-gradient(
    45deg,
    red 0px,
    red 10px,
    blue 10px,
    blue 20px
  );
  
  /* Anéis concêntricos */
  background: repeating-radial-gradient(
    circle at center,
    red 0px,
    red 10px,
    blue 10px,
    blue 20px
  );
  
  /* Padrão de raios repetidos */
  background: repeating-conic-gradient(
    from 0deg,
    red 0deg 15deg,
    blue 15deg 30deg
  );
}
```

## Funções de Formas

### `clip-path` com Funções de Forma

#### `circle()`

```css
.circle-clip {
  /* Raio e posição */
  clip-path: circle(50%);
  clip-path: circle(100px at center);
  clip-path: circle(50% at 25% 25%);
  
  /* Raio responsivo */
  clip-path: circle(clamp(50px, 10vw, 200px));
}
```

#### `ellipse()`

```css
.ellipse-clip {
  /* Raios horizontal e vertical */
  clip-path: ellipse(50% 25%);
  clip-path: ellipse(100px 50px at center);
  clip-path: ellipse(40% 30% at 75% 50%);
  
  /* Com closest-side e farthest-side */
  clip-path: ellipse(closest-side closest-side);
  clip-path: ellipse(farthest-side farthest-side);
}
```

#### `inset()`

```css
.inset-clip {
  /* Valores para top, right, bottom, left */
  clip-path: inset(10px);
  clip-path: inset(10px 20px 30px 40px);
  
  /* Com bordas arredondadas */
  clip-path: inset(10px round 10px);
  clip-path: inset(20px round 20px 10px);
  
  /* Percentuais */
  clip-path: inset(10% 20% 30% 40% round 5%);
}
```

#### `polygon()`

```css
.polygon-clip {
  /* Lista de pontos x y */
  clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%); /* Losango */
  
  /* Triângulo */
  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
  
  /* Forma complexa */
  clip-path: polygon(
    0% 0%,
    100% 0%,
    100% 75%,
    75% 75%,
    75% 100%,
    50% 75%,
    0% 75%
  );
  
  /* Estrela */
  clip-path: polygon(
    50% 0%, 61% 35%, 98% 35%, 68% 57%,
    79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%
  );
}
```

#### `path()`

Usa sintaxe SVG path para formas complexas.

```css
.path-clip {
  /* Comandos SVG: M (move), L (line), C (curve), Z (close) */
  clip-path: path('M 0 0 L 100 0 L 100 100 Z');
  
  /* Curva bezier */
  clip-path: path('M 0 100 C 0 0, 100 0, 100 100 Z');
  
  /* Forma complexa */
  clip-path: path('M 50 0 Q 100 25 100 50 T 50 100 Q 0 75 0 50 T 50 0');
}
```

### `shape-outside:`

Define formas para text wrapping ao redor de elementos flutuantes.

```css
.shape-float {
  float: left;
  width: 200px;
  height: 200px;
  
  /* Círculo */
  shape-outside: circle(50%);
  
  /* Elipse */
  shape-outside: ellipse(40% 50%);
  
  /* Polígono */
  shape-outside: polygon(0% 0%, 100% 0%, 100% 100%);
  
  /* Imagem com canal alfa */
  shape-outside: url('shape.png');
  
  /* Com margem */
  shape-outside: circle(50%);
  shape-margin: 20px;
  
  /* Gradiente como forma */
  shape-outside: linear-gradient(to right, transparent 50%, red 50%);
}
```

### `offset-path`

Define caminhos para animação de elementos.

```css
.path-animation {
  /* Círculo */
  offset-path: circle(50%);
  
  /* Elipse */
  offset-path: ellipse(40% 50%);
  
  /* Path SVG */
  offset-path: path('M 0 0 Q 100 100 200 0');
  
  /* Ray (linha reta) */
  offset-path: ray(45deg closest-side);
  
  /* URL de SVG */
  offset-path: url('#myPath');
  
  /* Distância ao longo do caminho */
  offset-distance: 50%;
  
  /* Rotação */
  offset-rotate: auto; /* Segue a tangente do caminho */
  offset-rotate: reverse; /* Oposto à tangente */
  offset-rotate: 45deg; /* Ângulo fixo */
  
  /* Âncora */
  offset-anchor: center;
  offset-anchor: 25% 75%;
}
```

## Funções que Referenciam Outros Valores

### `var()`

Referencia custom properties (variáveis CSS).

```css
:root {
  --primary-color: #007bff;
  --spacing: 1rem;
  --border-width: 2px;
}

.element {
  /* Uso básico */
  color: var(--primary-color);
  padding: var(--spacing);
  
  /* Com fallback */
  color: var(--secondary-color, #6c757d);
  
  /* Fallback aninhado */
  color: var(--color-1, var(--color-2, var(--color-3, black)));
  
  /* Em cálculos */
  margin: calc(var(--spacing) * 2);
  
  /* Concatenação (não funciona diretamente) */
  /* border: var(--border-width) solid var(--primary-color); */ /* Correto */
  /* border: var(--border-width solid --primary-color); */ /* Incorreto */
  
  /* Valores numéricos com unidades */
  --size: 10;
  width: calc(var(--size) * 1px); /* Adiciona unidade */
}
```

### `attr()`

Referencia atributos HTML (suporte limitado atualmente).

```css
.tooltip::after {
  /* Funciona apenas com content */
  content: attr(data-tooltip);
  
  /* Sintaxe estendida (futura) */
  /* width: attr(data-width px); */
  /* color: attr(data-color color, blue); */
}

/* Uso atual */
a::after {
  content: " (" attr(href) ")";
}

[data-icon]::before {
  content: attr(data-icon);
}
```

### `env()`

Acessa variáveis de ambiente do navegador.

```css
.safe-area {
  /* Áreas seguras em dispositivos com notch */
  padding-top: env(safe-area-inset-top);
  padding-right: env(safe-area-inset-right);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
  
  /* Com fallback */
  padding-top: env(safe-area-inset-top, 20px);
  
  /* Variáveis de teclado virtual */
  margin-bottom: env(keyboard-inset-height, 0px);
  
  /* Variáveis de título */
  padding-top: env(titlebar-area-height, 0px);
}
```

### Custom Properties com Tipagem

```css
@property --rotation {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

@property --color-stop {
  syntax: '<percentage>';
  initial-value: 50%;
  inherits: true;
}

@property --scale {
  syntax: '<number>';
  initial-value: 1;
  inherits: false;
}

.animated {
  --rotation: 0deg;
  transform: rotate(var(--rotation));
  transition: --rotation 1s;
}

.animated:hover {
  --rotation: 360deg; /* Anima suavemente */
}
```

## Funções de Grid e Layout

### `repeat()`

Repete tracks em CSS Grid.

```css
.grid {
  /* Repetição simples */
  grid-template-columns: repeat(3, 1fr);
  
  /* Padrão repetido */
  grid-template-columns: repeat(4, 100px 200px);
  
  /* auto-fill: preenche com o máximo de colunas possível */
  grid-template-columns: repeat(auto-fill, 200px);
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  
  /* auto-fit: similar ao auto-fill, mas colapsa tracks vazias */
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  
  /* Com cálculos */
  grid-template-columns: repeat(3, calc(100% / 3 - 20px));
}
```

### `minmax()`

Define range de tamanho mínimo e máximo.

```css
.grid {
  /* Tamanho entre 100px e 1fr */
  grid-template-columns: minmax(100px, 1fr);
  
  /* Múltiplas colunas */
  grid-template-columns: 
    minmax(200px, 300px) 
    minmax(300px, 1fr) 
    minmax(200px, 300px);
  
  /* Com auto */
  grid-template-columns: minmax(auto, 500px); /* Mínimo baseado em conteúdo */
  grid-template-columns: minmax(200px, auto); /* Máximo baseado em conteúdo */
  
  /* Com min-content e max-content */
  grid-template-columns: minmax(min-content, max-content);
  
  /* Linhas responsivas */
  grid-template-rows: minmax(100px, auto) 1fr minmax(50px, auto);
}
```

### `fit-content()`

Ajusta ao conteúdo com limite máximo.

```css
.grid {
  /* Tamanho baseado em conteúdo até o limite */
  grid-template-columns: fit-content(200px) 1fr;
  grid-template-columns: fit-content(40%) 1fr fit-content(30%);
  
  /* Equivalente a */
  /* minmax(auto, max-content) com limite superior */
  
  /* Uso em width/height */
  width: fit-content;
  max-width: 800px;
}
```

## Funções de Imagem

### `image()`

Função de imagem com fallbacks e direcionalidade.

```css
.element {
  /* Com fallback de cor */
  background-image: image('photo.jpg', blue);
  
  /* Múltiplos fallbacks */
  background-image: image('photo.webp', 'photo.jpg', 'photo.png');
  
  /* Com direcionalidade RTL/LTR */
  background-image: image(ltr 'arrow-right.png');
  background-image: image(rtl 'arrow-left.png');
  
  /* Fragmento de imagem */
  background-image: image('sprites.png#xywh=40,0,20,20');
}
```

### `image-set()`

Fornece múltiplas resoluções de imagem.

```css
.responsive-image {
  /* Para diferentes densidades de pixel */
  background-image: image-set(
    'image-1x.jpg' 1x,
    'image-2x.jpg' 2x,
    'image-3x.jpg' 3x
  );
  
  /* Com diferentes formatos */
  background-image: image-set(
    url('image.avif') type('image/avif'),
    url('image.webp') type('image/webp'),
    url('image.jpg') type('image/jpeg')
  );
  
  /* Combinando resolução e tipo */
  background-image: image-set(
    'image.avif' 1x type('image/avif'),
    'image@2x.avif' 2x type('image/avif'),
    'image.webp' 1x type('image/webp'),
    'image@2x.webp' 2x type('image/webp'),
    'image.jpg' 1x
  );
}
```

### `cross-fade()`

Cria transição entre imagens.

```css
.crossfade {
  /* Mistura duas imagens */
  background-image: cross-fade(
    url('image1.jpg'),
    url('image2.jpg'),
    50%
  );
  
  /* Sintaxe alternativa */
  background-image: cross-fade(
    url('image1.jpg') 70%,
    url('image2.jpg') 30%
  );
  
  /* Com cores */
  background-image: cross-fade(
    url('image.jpg') 60%,
    blue 40%
  );
}
```

### `element()`

Usa outro elemento como imagem (Firefox).

```css
.reference {
  /* Referencia elemento por ID */
  background: element(#sourceElement);
  
  /* Uso para criar reflexos ou duplicações */
}

#sourceElement {
  /* Elemento fonte */
}
```

## Funções de Contadores

### `counter()` e `counters()`

Exibe valores de contadores CSS.

```css
body {
  counter-reset: section 0 subsection 0;
}

h2 {
  counter-increment: section;
  counter-reset: subsection;
}

h2::before {
  content: counter(section) ". ";
  
  /* Com estilo de numeração */
  content: counter(section, upper-roman) ". ";
  content: counter(section, lower-alpha) ". ";
  content: counter(section, decimal-leading-zero) ". ";
}

h3 {
  counter-increment: subsection;
}

h3::before {
  /* Contadores aninhados */
  content: counters(section, ".") "." counter(subsection) " ";
  
  /* Com separador customizado e estilo */
  content: counters(section, "-", upper-alpha) "." counter(subsection) " ";
}

/* Estilos de lista disponíveis */
ol.custom {
  list-style: none;
  counter-reset: item;
}

ol.custom li {
  counter-increment: item;
}

ol.custom li::before {
  /* decimal, decimal-leading-zero, lower-roman, upper-roman,
     lower-alpha, upper-alpha, lower-greek, hebrew, armenian,
     georgian, cjk-ideographic, hiragana, katakana, etc. */
  content: counter(item, lower-greek) ") ";
}
```

### `symbols()`

Define símbolos customizados para contadores.

```css
ol {
  list-style: symbols(cyclic '★' '☆' '✦');
  
  /* Tipos: cyclic, numeric, alphabetic, symbolic, fixed */
  list-style: symbols(numeric '➊' '➋' '➌' '➍' '➎');
  list-style: symbols(alphabetic 'A' 'B' 'C');
  list-style: symbols(fixed '1º' '2º' '3º');
}
```

## Funções de Conteúdo Gerado

### `content()` e Suas Variações

```css
.generated::before {
  /* Texto simples */
  content: "Prefixo: ";
  
  /* Atributo */
  content: attr(data-label);
  
  /* Contador */
  content: counter(item);
  
  /* String vazia (para criar pseudo-elemento) */
  content: "";
  
  /* URL de imagem */
  content: url('icon.svg');
  
  /* Múltiplos valores concatenados */
  content: counter(chapter) ": " attr(title);
  
  /* Aspas */
  content: open-quote;
  content: close-quote;
  content: no-open-quote;
  content: no-close-quote;
}

/* Aspas customizadas */
q {
  quotes: "«" "»" "‹" "›";
}

q::before {
  content: open-quote;
}

q::after {
  content: close-quote;
}
```

## Funções de Animação e Timing

### `Cubic-bezier()`

Define curvas de aceleração customizadas.

```css
.animated {
  /* Curva cubic-bezier customizada */
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  
  /* Predefinidas equivalentes */
  /* ease: cubic-bezier(0.25, 0.1, 0.25, 1) */
  /* ease-in: cubic-bezier(0.42, 0, 1, 1) */
  /* ease-out: cubic-bezier(0, 0, 0.58, 1) */
  /* ease-in-out: cubic-bezier(0.42, 0, 0.58, 1) */
  /* linear: cubic-bezier(0, 0, 1, 1) */
  
  /* Curvas avançadas */
  transition-timing-function: cubic-bezier(0.68, -0.55, 0.265, 1.55); /* Back */
  transition-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Elastic */
}
```

### `steps()`

Define animação em passos discretos.

```css
.stepped {
  /* Número de passos */
  animation-timing-function: steps(5);
  
  /* Com posição do salto */
  animation-timing-function: steps(5, jump-start); /* Muda no início */
  animation-timing-function: steps(5, jump-end); /* Muda no final (padrão) */
  animation-timing-function: steps(5, jump-both); /* Muda em ambos */
  animation-timing-function: steps(5, jump-none); /* Sem mudança nos extremos */
  
  /* Atalhos */
  animation-timing-function: step-start; /* steps(1, jump-start) */
  animation-timing-function: step-end; /* steps(1, jump-end) */
  
  /* Útil para sprite animations */
  animation: sprite 1s steps(10) infinite;
}

@keyframes sprite {
  from { background-position: 0 0; }
  to { background-position: -1000px 0; }
}
```

### `linear()`

Define easing com múltiplos pontos lineares.

```css
.smooth-animation {
  /* Múltiplos pontos de interpolação linear */
  animation-timing-function: linear(
    0, 0.25, 0.5, 0.75, 1
  );
  
  /* Com posições específicas */
  animation-timing-function: linear(
    0, 0.1 20%, 0.5 50%, 0.9 80%, 1
  );
  
  /* Aproxima bounce */
  animation-timing-function: linear(
    0, 0.5 25%, 1 50%, 0.75 75%, 1
  );
}
```

## Funções de Medidas e Viewports

### Unidades de Viewport

```css
.viewport-units {
  /* Viewport relativas */
  height: 100vh; /* Viewport height */
  width: 100vw; /* Viewport width */
  font-size: 5vmin; /* Menor entre vw e vh */
  font-size: 5vmax; /* Maior entre vw e vh */
  
  /* Novas unidades (Large, Small, Dynamic) */
  height: 100lvh; /* Large viewport height */
  height: 100svh; /* Small viewport height */
  height: 100dvh; /* Dynamic viewport height */
  
  width: 100lvw;
  width: 100svw;
  width: 100dvw;
  
  /* Container queries */
  font-size: 5cqw; /* Container query width */
  padding: 2cqh; /* Container query height */
  margin: 3cqi; /* Container query inline */
  gap: 2cqb; /* Container query block */
  font-size: 4cqmin;
  font-size: 4cqmax;
}

/* Diferenças importantes:
   - vh pode incluir/excluir barras de navegação conforme navegador
   - lvh: viewport quando barras estão ocultas (maior)
   - svh: viewport quando barras estão visíveis (menor)
   - dvh: ajusta dinamicamente conforme barras aparecem/desaparecem
*/
```

## Funções Matemáticas Especiais

### Operadores e Comparações

```css
.comparisons {
  /* Mantém valor dentro do range */
  width: clamp(100px, 50vw, 500px);
  
  /* Interpolação linear */
  font-size: calc(1rem + (2 - 1) * ((100vw - 320px) / (1920 - 320)));
  
  /* Valor escalonado */
  --scale: calc((100vw - 320px) / (1920 - 320));
  padding: calc(1rem + 2rem * var(--scale));
}
```

## Funções de Seleção e Posição

### `:is()`, `:where()`, `:has()`

Embora sejam pseudo-classes, funcionam como funções de seleção.

```css
/* :is() - especificidade do seletor mais específico */
:is(header, main, footer) p {
  margin: 1rem;
}

/* Equivalente a */
header p, main p, footer p {
  margin: 1rem;
}

/* :where() - especificidade zero */
:where(header, main, footer) p {
  margin: 1rem;
}

/* :has() - seletor relacional (parent selector) */
article:has(> img) {
  display: grid;
}

.card:has(.icon) {
  padding-left: 3rem;
}

/* Combinações complexas */
form:has(input:invalid) button {
  opacity: 0.5;
  pointer-events: none;
}

section:has(> h2 + p) {
  /* Seção que tem h2 seguido imediatamente de p */
}
```

## Funções Avançadas e Experimentais

### `anchor()`

Posicionamento relativo a elemento âncora (CSS Anchor Positioning).

```css
.anchor-element {
  anchor-name: --my-anchor;
}

.positioned {
  position: absolute;
  
  /* Alinha com a âncora */
  top: anchor(--my-anchor bottom);
  left: anchor(--my-anchor left);
  
  /* Com fallback */
  top: anchor(--my-anchor bottom, 0);
  
  /* Dimensões baseadas na âncora */
  width: anchor-size(--my-anchor width);
  height: anchor-size(--my-anchor height);
  
  /* Posicionamento inteligente */
  position-fallback: --fallback-positions;
}

@position-fallback --fallback-positions {
  @try {
    top: anchor(bottom);
    left: anchor(left);
  }
  
  @try {
    bottom: anchor(top);
    left: anchor(left);
  }
}
```

### `scroll()`

Controla animações baseadas em scroll (Scroll-driven Animations).

```css
@keyframes slide {
  from { transform: translateX(-100%); }
  to { transform: translateX(100%); }
}

.scroll-animation {
  animation: slide linear;
  
  /* Vincula ao scroll */
  animation-timeline: scroll();
  
  /* Scroll de container específico */
  animation-timeline: scroll(nearest);
  animation-timeline: scroll(root);
  animation-timeline: scroll(self);
  
  /* Direção do scroll */
  animation-timeline: scroll(block); /* Vertical */
  animation-timeline: scroll(inline); /* Horizontal */
  animation-timeline: scroll(y);
  animation-timeline: scroll(x);
}
```

### `view()`

Animação baseada na visibilidade do elemento no viewport.

```css
.reveal {
  animation: fadeIn linear;
  animation-timeline: view();
  
  /* Com offset */
  animation-range: entry 0% entry 100%;
  animation-range: contain 0% contain 100%;
  animation-range: exit 0% exit 100%;
  
  /* Combinações */
  animation-range: entry 25% exit 75%;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(50px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
```

## Performance e Otimização

### Funções que Ativam GPU

Transformações 3D e certos filtros podem ativar aceleração de hardware:

```css
.hardware-accelerated {
  /* Force GPU acceleration */
  transform: translateZ(0);
  transform: translate3d(0, 0, 0);
  will-change: transform;
  
  /* Filtros com backdrop-filter */
  backdrop-filter: blur(10px);
  
  /* Isolamento para otimização */
  isolation: isolate;
}
```

### Contain e Content-visibility

```css
.optimized {
  /* Containment para otimização de rendering */
  contain: layout style paint;
  contain: strict; /* layout + style + paint + size */
  contain: content; /* layout + style + paint */
  
  /* Content visibility */
  content-visibility: auto; /* Renderiza apenas se visível */
  content-visibility: hidden; /* Não renderiza */
  contain-intrinsic-size: 0 500px; /* Tamanho placeholder */
}
```

## Práticas Avançadas e Patterns

### Design Tokens com Funções

```css
:root {
  /* Tokens base */
  --color-primary-h: 220;
  --color-primary-s: 80%;
  --color-primary-l: 50%;
  
  /* Função para gerar variações */
  --color-primary: hsl(
    var(--color-primary-h)
    var(--color-primary-s)
    var(--color-primary-l)
  );
  
  /* Variações automáticas */
  --color-primary-light: hsl(
    var(--color-primary-h)
    var(--color-primary-s)
    calc(var(--color-primary-l) + 20%)
  );
  
  --color-primary-dark: hsl(
    var(--color-primary-h)
    var(--color-primary-s)
    calc(var(--color-primary-l) - 20%)
  );
  
  /* Spacing scale */
  --spacing-unit: 0.25rem;
  --spacing-xs: calc(var(--spacing-unit) * 2);
  --spacing-sm: calc(var(--spacing-unit) * 4);
  --spacing-md: calc(var(--spacing-unit) * 6);
  --spacing-lg: calc(var(--spacing-unit) * 8);
  --spacing-xl: calc(var(--spacing-unit) * 12);
  
  /* Fluid typography */
  --fluid-min-width: 320;
  --fluid-max-width: 1920;
  --fluid-min-size: 16;
  --fluid-max-size: 24;
  --fluid-min-ratio: 1.2;
  --fluid-max-ratio: 1.333;
}

.fluid-text {
  font-size: clamp(
    calc(var(--fluid-min-size) * 1px),
    calc(
      (var(--fluid-min-size) * 1px) + 
      (var(--fluid-max-size) - var(--fluid-min-size)) * 
      ((100vw - (var(--fluid-min-width) * 1px)) / 
      (var(--fluid-max-width) - var(--fluid-min-width)))
    ),
    calc(var(--fluid-max-size) * 1px)
  );
}
```

### Temas Dinâmicos

```css
@media (prefers-color-scheme: dark) {
  :root {
    --bg: hsl(220 20% 10%);
    --text: hsl(220 20% 90%);
  }
}

@media (prefers-color-scheme: light) {
  :root {
    --bg: hsl(220 20% 98%);
    --text: hsl(220 20% 15%);
  }
}

/* Transição suave entre temas */
* {
  transition: 
    background-color 0.3s ease,
    color 0.3s ease;
}

/* Modo de alto contraste */
@media (prefers-contrast: high) {
  :root {
    --text: hsl(0 0% 0%);
    --bg: hsl(0 0% 100%);
  }
}
```

### Aspect Ratio Responsivo

```css
.aspect-box {
  /* Aspect ratio nativo */
  aspect-ratio: 16 / 9;
  aspect-ratio: 1;
  aspect-ratio: 4 / 3;
  
  /* Com fallback usando padding */
  aspect-ratio: 16 / 9;
}

@supports not (aspect-ratio: 1) {
  .aspect-box::before {
    content: "";
    float: left;
    padding-top: calc(9 / 16 * 100%);
  }
  
  .aspect-box::after {
    content: "";
    display: table;
    clear: both;
  }
}
```

### Logical Properties

```css
.logical {
  /* Ao invés de left/right, top/bottom */
  margin-inline: 1rem; /* left + right em LTR */
  margin-block: 2rem; /* top + bottom */
  
  padding-inline-start: 1rem; /* left em LTR, right em RTL */
  padding-inline-end: 1rem;
  padding-block-start: 1rem; /* top */
  padding-block-end: 1rem; /* bottom */
  
  border-inline: 1px solid black;
  border-block: 2px solid black;
  
  inset-inline-start: 0; /* left em LTR */
  inset-block-start: 0; /* top */
  
  /* Tamanhos */
  inline-size: 100%; /* width em modo horizontal */
  block-size: 50vh; /* height em modo horizontal */
  
  min-inline-size: 200px;
  max-block-size: 80vh;
}
```

## Considerações de Compatibilidade

### Feature Queries

```css
/* Verificação de suporte a funções */
@supports (display: grid) {
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  }
}

@supports (backdrop-filter: blur(10px)) {
  .glass {
    backdrop-filter: blur(10px);
  }
}

@supports (color: lab(50% 0 0)) {
  :root {
    --primary: lab(60% 30 -20);
  }
}

/* Verificação negativa */
@supports not (display: grid) {
  .grid {
    display: flex;
    flex-wrap: wrap;
  }
}

/* Combinações lógicas */
@supports (display: grid) and (gap: 1rem) {
  .modern-grid {
    display: grid;
    gap: 1rem;
  }
}

@supports (display: grid) or (display: flex) {
  .flexible {
    /* Estilos para navegadores modernos */
  }
}
```

### Fallbacks Estratégicos

```css
.element {
  /* Fallback progressivo */
  background: blue; /* Fallback sólido */
  background: linear-gradient(blue, navy); /* Gradiente */
  background: linear-gradient(in oklch, blue, navy); /* Espaço de cor moderno */
  
  /* Múltiplas declarações */
  width: 500px; /* Fixo */
  width: 80vw; /* Viewport */
  width: min(80vw, 800px); /* Responsivo com limite */
  width: clamp(300px, 80vw, 800px); /* Totalmente fluido */
}
```

## Conclusão

CSS Functions representam uma das áreas mais dinâmicas e poderosas da especificação CSS moderna. A evolução contínua da linguagem introduz novas capacidades que permitem criar interfaces cada vez mais sofisticadas e performáticas, desde transformações complexas até sistemas de cor perceptualmente precisos.

O domínio dessas funções possibilita:

- Layouts responsivos e adaptativos sem JavaScript
- Sistemas de design escaláveis e manuteníveis
- Animações e transições de alta performance
- Manipulação precisa de cores e espaços cromáticos
- Posicionamento contextual e relacional
- Otimizações automáticas de rendering

A chave para utilização efetiva está em compreender não apenas a sintaxe, mas também as implicações de performance, compatibilidade e casos de uso adequados para cada função. A combinação estratégica de múltiplas funções frequentemente resulta nas soluções mais elegantes e eficientes.

À medida que navegadores implementam novas especificações, é fundamental acompanhar as funcionalidades emergentes enquanto mantém estratégias de fallback apropriadas para garantir experiências consistentes em diferentes ambientes.
